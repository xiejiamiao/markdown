# 经销商接口业务逻辑



## 用户登录

1. 判断用户是否为KA用户(判断标准：自身是否为KA用户、最顶层的经销商是否为KA用户)


## 去订货

1. KA用户：
   1. 根据最顶层(自身)的经销商ID查询可订货的商品，再根据`用户 + 商品 + 模板 `的判断查询到价格模板，进货区域选择最低级别价格，不进货区域选择模板中不进货价格
   2. 如果自己为最顶层经销商，则查询指定商品公司的的库存
   3. 如果有上级经销商，则查询上级经销商的库存（如果上级经销商没库存？）
2. 普通用户：
   1. 查询公司自营商品，即KA用户与经销商商品映射表中`DealerId=0  `，再根据`用户 + 商品 + 模板 `的判断查询到价格模板，进货区域选择最低级别价格，不进货区域选择模板中不进货价格
   2. 查询公司库存
3. 进货单：
   1. 查询当前添加到 进货单 中的商品基础信息
   2. 价格：
      1. KA用户：
         1. 根据价格模板，按照商品数量进行价格等级查询
      2. 普通用户：
         1. 查询价格模板与经销商商品映射表中 `DealerId=0`
         2. 根据价格模板，按照商品数量进行价格等级查询